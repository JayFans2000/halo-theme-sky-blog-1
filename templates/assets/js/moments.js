window.handleMomentUpvote=async function(t){const e=t.dataset.momentName;if(!e)return;const n=JSON.parse(localStorage.getItem("halo.upvoted.moment.names")||"[]");if(!n.includes(e))try{if((await fetch("/apis/api.halo.run/v1alpha1/trackers/upvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group:"moment.halo.run",plural:"moments",name:e})})).ok){const s=t.querySelector(".upvote-count"),c=parseInt(s.textContent)||0;s.textContent=c+1;const a=t.querySelector('span[class*="icon"]');a&&(a.className=a.className.replace("icon-[heroicons--heart]","icon-[heroicons--heart-solid]"),t.classList.add("text-error"),t.classList.remove("text-base-content/50")),n.push(e),localStorage.setItem("halo.upvoted.moment.names",JSON.stringify(n))}}catch(o){console.error("点赞失败:",o)}};document.addEventListener("DOMContentLoaded",function(){const t=JSON.parse(localStorage.getItem("halo.upvoted.moment.names")||"[]");document.querySelectorAll("[data-moment-name]").forEach(function(e){const n=e.dataset.momentName;if(t.includes(n)){const o=e.querySelector('span[class*="icon"]');o&&(o.className=o.className.replace("icon-[heroicons--heart]","icon-[heroicons--heart-solid]"),e.classList.add("text-error"),e.classList.remove("text-base-content/50"))}})});
