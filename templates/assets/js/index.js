(function(){const g="sky_weather_cache_v12",u={sunBody:`<svg viewBox="0 0 200 200" class="w-full h-full fill-current text-yellow-400">
                <circle cx="100" cy="100" r="60" />
                <g class="sun-face" fill="#cc9900">
                  <circle cx="75" cy="90" r="8" />
                  <circle cx="125" cy="90" r="8" />
                  <path d="M70 120 Q100 145 130 120" stroke="#cc9900" stroke-width="6" fill="none" stroke-linecap="round" />
                  <ellipse cx="60" cy="105" rx="6" ry="3" fill="#ff7e7e" opacity="0.6" />
                  <ellipse cx="140" cy="105" rx="6" ry="3" fill="#ff7e7e" opacity="0.6" />
                </g>
              </svg>`,sunRays:`<svg viewBox="0 0 200 200" class="w-full h-full stroke-current text-yellow-400">
                <g stroke-width="12" stroke-linecap="round">
                  <path d="M100 20 L100 0 M100 180 L100 200 M20 100 L0 100 M180 100 L200 100 M43 43 L29 29 M157 157 L171 171 M43 157 L29 171 M157 43 L171 29" />
                </g>
              </svg>`,moon:`<svg viewBox="0 0 200 200" class="w-full h-full fill-current text-yellow-100">
             <path d="M100 15 A 85 85 0 1 1 100 185 A 65 65 0 1 0 100 15 Z" />
             <circle cx="80" cy="80" r="12" fill="rgba(0,0,0,0.1)" />
             <circle cx="120" cy="120" r="8" fill="rgba(0,0,0,0.1)" />
             <circle cx="90" cy="140" r="5" fill="rgba(0,0,0,0.1)" />
           </svg>`,cloud:`<svg viewBox="0 0 25 25" class="w-full h-full fill-current">
              <path d="M19.5,10 C19.5,6.96 17.04,4.5 14,4.5 C11.6,4.5 9.55,6.03 8.8,8.2 C8.54,8.13 8.27,8.1 8,8.1 C5.24,8.1 3,10.34 3,13.1 C3,15.86 5.24,18.1 8,18.1 L19.5,18.1 C21.98,18.1 24,16.08 24,14 C24,11.92 21.98,10 19.5,10 Z" />
            </svg>`};let w={type:"sunny",temp:20},v=null,d=null;function C(){v=document.getElementById("weather-effect-root"),v&&(d=v.querySelector(".weather-effect-layer"),d&&(X(),k(),K(),window.addEventListener("sky-weather-updated",e=>{const t=e.detail?.weatherBg;if(t&&t!==w.type){let a=t;t==="rain"&&(a="rainy"),t==="snow"&&(a="snowy"),t==="fog"&&(a="foggy"),w.type=a,k()}})))}function X(){try{const t=localStorage.getItem(g);if(t){const a=JSON.parse(t),s=a.weatherBg;if(s){let r=s;s==="rain"&&(r="rainy"),s==="snow"&&(r="snowy"),s==="fog"&&(r="foggy"),w.type=r,w.temp=parseFloat(a.weather?.temp||20);return}}}catch{}const e=new Date().getHours();w.type=e>=18||e<6?"night-clear":"sunny"}function k(){if(!d)return;d.lastElementChild&&typeof d.lastElementChild._cleanup=="function"&&d.lastElementChild._cleanup(),d.innerHTML="";const e=v.querySelector(".weather-effect");switch(e&&(e.className="weather-effect weather-"+w.type,e.style.setProperty("--wind-force",1)),_(),w.type){case"sunny":T();break;case"cloudy":b(!1);break;case"night-clear":W();break;case"night-cloudy":b(!0);break;case"foggy":G();break;case"rainy":O();break;case"snowy":J();break;case"stormy":Y();break}const t=document.createElement("div");t.className="bottom-fade",d.appendChild(t)}function _(){const e=document.createElement("div");e.className="atmosphere-glow",d.appendChild(e)}function T(){const e=document.createElement("div");e.className="sunny-scene-container";const t=document.createElement("div");t.className="sunny-lawn",e.appendChild(t);for(let n=0;n<40;n++){const i=document.createElement("div");i.className="sunny-grass-blade",i.style.left=`${Math.random()*100}%`,i.style.height=`${15+Math.random()*25}px`,i.style.animationDelay=`${-Math.random()*4}s`,t.appendChild(i)}const a=["flower-type-tulip","flower-type-daisy","flower-type-sunflower"];for(let n=0;n<12;n++){const i=document.createElement("div"),l=a[Math.floor(Math.random()*a.length)];i.className=`sunny-flower-detailed ${l}`;const c=document.createElement("div");c.className="flower-head",i.appendChild(c),i.style.left=`${5+Math.random()*90}%`,i.style.height=`${40+Math.random()*40}px`,i.style.animationDelay=`${-Math.random()*5}s`,i.style.transform=`scale(${.7+Math.random()*.5})`,t.appendChild(i)}d.appendChild(e);const s=document.createElement("div");s.className="sun-container";const r=document.createElement("div");r.className="sun-rays",r.innerHTML=u.sunRays,s.appendChild(r);const m=document.createElement("div");m.className="sun-body",m.innerHTML=u.sunBody,s.appendChild(m);const o=document.createElement("div");o.className="sun-glow-outer",s.appendChild(o),d.appendChild(s);for(let n=0;n<15;n++)q()}function q(){const e=document.createElement("div");e.className="bokeh-particle";const t=20+Math.random()*60;e.style.cssText=`
      width: ${t}px; height: ${t}px;
      left: ${Math.random()*100}%; top: ${Math.random()*80}%;
      opacity: ${.1+Math.random()*.2};
      animation-duration: ${15+Math.random()*20}s;
      animation-delay: ${-Math.random()*20}s;
    `,d.appendChild(e)}function b(e){e?(S(),I(30,!0),z(!0)):T();const t=e?5:8;for(let a=0;a<t;a++)B(e)}function B(e,t){const a=document.createElement("div");a.className="cloud-cartoon "+(e?"night":"day"),a.innerHTML=u.cloud;const s=.6+Math.random()*1.2,r=5+Math.random()*50,m=60+(1.8-s)*40+Math.random()*30,o=e?.3+Math.random()*.2:.85+Math.random()*.15,n=Math.random()*300;a.style.cssText=`
      top: ${r}%;
      left: 0;
      --cloud-scale: ${s};
      --cloud-start-offset: ${n}px;
      opacity: ${o};
      animation-duration: ${m}s;
      animation-delay: ${-Math.random()*m}s;
      z-index: ${20+Math.floor(s*10)};
      color: ${e?"#a0a4b8":"#ffffff"};
    `,d.appendChild(a)}function W(){S(),I(50,!0),z(!1)}function S(){const e=document.createElement("div");e.className="night-scene-container",e.id="night-scene",["sm-1","sm-2"].forEach(o=>{const n=document.createElement("div");n.className=`spooky-mountain ${o}`,e.appendChild(n)});for(let o=0;o<6;o++){const n=document.createElement("div");n.className="spooky-tree";const i=180+Math.random()*100,l=i*.6;n.style.cssText=`
            left: ${-10+Math.random()*110}%; // 覆盖稍宽范围
            width: ${l}px;
            height: ${i}px;
            z-index: ${2+Math.random()*2};
            transform: scaleX(${Math.random()>.5?1:-1}); // 随机翻转
        `,e.appendChild(n)}d.appendChild(e);const s=setInterval(()=>{if(!document.getElementById("night-scene"))return;const o=document.createElement("div"),n=Math.random()>.7;o.className=`spooky-eye-pair ${n?"eyes-yellow":""}`,o.style.left=`${Math.random()*100}%`,o.style.bottom=`${20+Math.random()*100}px`,o.style.animationDelay=`${Math.random()*2}s`,e.appendChild(o),setTimeout(()=>o.remove(),4e3)},2e3),m=setInterval(()=>{if(!document.getElementById("night-scene"))return;const o=document.createElement("div");o.className="ghost-firefly",o.style.left=`${Math.random()*100}%`,o.style.bottom=`${Math.random()*50}%`,e.appendChild(o),setTimeout(()=>o.remove(),8e3)},1500);e._cleanup=()=>{clearInterval(s),clearInterval(m)}}function z(e){const t=document.createElement("div");t.className="moon-container",e&&t.classList.add("cloudy-moon");const a=document.createElement("div");a.className="moon-icon",a.innerHTML=u.moon,t.appendChild(a);const s=document.createElement("div");s.className="moon-glow",t.appendChild(s),d.appendChild(t)}function I(e,t=!1){for(let a=0;a<e;a++){const s=document.createElement("div");s.className="star",t&&s.classList.add("dim");const r=1+Math.random()*3;s.style.cssText=`
        width: ${r}px; height: ${r}px;
        left: ${Math.random()*100}%; top: ${Math.random()*60}%;
        animation-duration: ${2+Math.random()*3}s;
        animation-delay: ${-Math.random()*3}s;
      `,d.appendChild(s)}}function G(){const e=document.createElement("div");e.className="mist-scene-container",e.id="mist-scene";const t=document.createElement("div");t.className="mist-sun",e.appendChild(t),["m-1","m-2","m-3"].forEach(l=>{const c=document.createElement("div");c.className=`mist-mountain ${l}`,e.appendChild(c)}),["t-1","t-2","t-3","t-4"].forEach(l=>{const c=document.createElement("div");c.className=`mist-tree ${l}`,e.appendChild(c)});const r=["mist-layer-2","mist-layer-1","mist-layer-3"],m=[];r.forEach(l=>{const c=document.createElement("div");c.className=`mist-fog-layer ${l}`,e.appendChild(c),m.push(c)}),d.appendChild(e);const n=setInterval(()=>{if(!document.getElementById("mist-scene"))return;const l=document.createElement("div");l.className="mist-fog-puff";const c=Math.random()*180+60,f=Math.random()*35+55,y=Math.random()*10+12,x=(Math.random()-.5)*400;l.style.cssText=`
        width: ${c}px; height: ${c}px;
        top: ${f}%; left: ${Math.random()*100}%;
      `;const M=l.animate([{transform:"translate(0, 0) scale(0.5)",opacity:0},{opacity:.5,offset:.2},{opacity:.5,offset:.8},{transform:`translate(${x}px, -80px) scale(1.8)`,opacity:0}],{duration:y*1e3,easing:"linear",fill:"forwards"});e.appendChild(l),M.onfinish=()=>l.remove()},600),i=l=>{const c=l.clientX/window.innerWidth;m[1]&&(m[1].style.transform=`translateX(${-c*50}px)`),m[0]&&(m[0].style.transform=`translateX(${c*20}px) scaleX(-1)`),m[2]&&(m[2].style.transform=`translateX(${-c*90}px)`)};document.addEventListener("mousemove",i),e._cleanup=()=>{clearInterval(n),document.removeEventListener("mousemove",i)}}function O(){H(!1)}function Y(){H(!0)}function H(e){for(let h=0;h<(e?8:5);h++)B(!0);const t=window.innerWidth,a=e?t/10:t/25,s=Math.min(e?150:60,Math.max(20,Math.floor(a))),r=e?{count:s,speedBase:14,wind:-6,thickness:3,color:"rgba(130, 180, 255, 0.8)"}:{count:s,speedBase:8,wind:-2,thickness:2,color:"rgba(174, 217, 255, 0.6)"},m=document.createElement("canvas");m.className="rain-canvas",m.id="rain-canvas",d.appendChild(m);const o=document.createElement("canvas");o.className="lightning-canvas",o.id="lightning-canvas",d.appendChild(o);const n=document.createElement("div");n.className="flash-overlay",n.id="flash-overlay",d.appendChild(n);const i=document.createElement("div");i.className="rain-ground-props",Z(i),d.appendChild(i);const l=m.getContext("2d"),c=o.getContext("2d");let f,y,x=[],M=[],D=null,L=0;function F(){f=m.width=o.width=d.offsetWidth||window.innerWidth,y=m.height=o.height=d.offsetHeight||window.innerHeight,x.forEach(h=>{h.x>f&&(h.x=Math.random()*f)})}F();let P;const R=()=>{clearTimeout(P),P=setTimeout(()=>{F()},200)};window.addEventListener("resize",R);class Q{constructor(p=!1){this.x=Math.random()*f,this.y=p?Math.random()*y:-50,this.z=Math.random(),this.speed=r.speedBase*(1+this.z)+Math.random()*2,this.len=10+this.z*15,this.thick=r.thickness*(.5+this.z*.5),this.vx=r.wind*(1+(1-this.z))}update(){this.x+=this.vx,this.y+=this.speed,this.y>y-40&&(Math.random()>.85&&M.push(new V(this.x,y-40)),this.reset()),this.x<0&&(this.x=f),this.x>f&&(this.x=0)}reset(){this.x=Math.random()*f,this.y=-50,this.z=Math.random(),this.speed=r.speedBase*(1+this.z)+Math.random()*2}draw(){l.beginPath(),l.moveTo(this.x,this.y),l.lineTo(this.x-this.vx*2,this.y-this.len),l.strokeStyle=r.color,l.lineWidth=this.thick,l.lineCap="round",l.stroke()}}class V{constructor(p,E){this.x=p,this.y=E,this.life=8,this.particles=[];for(let N=0;N<3;N++)this.particles.push({vx:(Math.random()-.5)*4,vy:-Math.random()*3,px:0,py:0})}update(){this.life--,this.particles.forEach(p=>{p.px+=p.vx,p.py+=p.vy,p.vy+=.3})}draw(){const p=this.life/8;l.fillStyle=`rgba(200, 230, 255, ${p})`,this.particles.forEach(E=>{l.beginPath(),l.arc(this.x+E.px,this.y+E.py,2,0,Math.PI*2),l.fill()})}}for(let h=0;h<r.count;h++)x.push(new Q(!0));function j(){c.clearRect(0,0,f,y),c.beginPath();let p=f*.2+Math.random()*f*.6,E=0;for(c.moveTo(p,E);E<y*.7;){const N=(Math.random()-.5)*80,ee=20+Math.random()*40;p+=N,E+=ee,c.lineTo(p,E)}c.strokeStyle="#fff",c.shadowBlur=25,c.shadowColor="#f1c40f",c.lineWidth=3,c.stroke(),c.shadowBlur=0,setTimeout(()=>c.clearRect(0,0,f,y),120)}function U(){n.style.opacity="0.7",setTimeout(()=>{n.style.opacity="0"},80),setTimeout(()=>{n.style.opacity="0.3"},120),setTimeout(()=>{n.style.opacity="0"},200),v.classList.add("weather-shake"),setTimeout(()=>v.classList.remove("weather-shake"),400),j()}function A(){if(document.getElementById("rain-canvas")){l.clearRect(0,0,f,y),x.forEach(h=>{h.update(),h.draw()});for(let h=M.length-1;h>=0;h--)M[h].update(),M[h].draw(),M[h].life<=0&&M.splice(h,1);if(e){const h=Date.now();h>L&&(U(),L=h+2500+Math.random()*4e3)}D=requestAnimationFrame(A)}}L=Date.now()+1e3,A();const $=document.createElement("div");$.id="rain-system",$.style.display="none",$._cleanup=()=>{cancelAnimationFrame(D),window.removeEventListener("resize",R)},d.appendChild($)}function Z(e){const t=document.createElement("div");t.className="rain-meadow-container",["rm-hill-2","rm-hill-1","rm-hill-3"].forEach(o=>{const n=document.createElement("div");n.className=`rain-meadow-hill ${o}`,t.appendChild(n)}),e.appendChild(t);const a=document.createElement("div");a.className="rain-puddle",a.style.cssText="width: 80px; height: 25px; left: 25%; bottom: 15px;",e.appendChild(a);const s=document.createElement("div");s.className="flat-rain-path",e.appendChild(s);const r=document.createElement("div");r.className="flat-rain-house",r.innerHTML=`
          <div class="house-chimney"></div>
          <div class="house-window"></div>
      `,e.appendChild(r);const m=document.createElement("div");m.className="flat-rain-lamp",m.innerHTML=`
          <div class="lamp-head"></div>
          <div class="lamp-light"></div> 
      `,e.appendChild(m)}function J(){const e=document.createElement("div");e.className="snow-scene-container",["sh-1","sh-2"].forEach(n=>{const i=document.createElement("div");i.className=`snow-hill ${n}`,e.appendChild(i)});const a=document.createElement("div");a.className="snow-ground",e.appendChild(a);const s=document.createElement("div");s.className="snow-igloo";const r=document.createElement("div");r.className="snow-igloo-entrance",s.appendChild(r),e.appendChild(s),["sp-1","sp-2","sp-3"].forEach(n=>{const i=document.createElement("div");i.className=`snow-pine ${n}`,e.appendChild(i)}),d.appendChild(e);const o=document.createElement("div");o.className="snow-container";for(let n=0;n<80;n++){const i=document.createElement("div");i.className="snow-flake-svg";const l=Math.random()<.3,c=l?12+Math.random()*10:4+Math.random()*8,f=l?6+Math.random()*4:3+Math.random()*5;Math.random()>.4?i.innerHTML='<svg viewBox="0 0 24 24" class="w-full h-full fill-current"><circle cx="12" cy="12" r="8"/></svg>':i.innerHTML='<svg viewBox="0 0 24 24" class="w-full h-full stroke-current" stroke-width="2"><path d="M12 2v20M2 12h20M4.93 4.93l14.14 14.14M4.93 19.07L19.07 4.93"/></svg>';const y=20;i.style.cssText=`
        left: ${Math.random()*100}%;
        width: ${c}px; height: ${c}px;
        opacity: ${l?.95:.6+Math.random()*.3};
        --wind-offset: ${y}px;
        animation-duration: ${f}s;
        animation-delay: ${-Math.random()*f}s;
      `,o.appendChild(i)}d.appendChild(o)}function K(){const e=v.querySelector(".scroll-mask");if(!e)return;let t=!1;window.addEventListener("scroll",()=>{t||(requestAnimationFrame(()=>{e.style.opacity=window.scrollY>50?"0.3":"0",t=!1}),t=!0)},{passive:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{C()}):C()})();window.handleMomentCardGlow=function(g,u){const w=u.querySelector(".moment-glow");if(!w)return;const v=u.getBoundingClientRect(),d=g.clientX-v.left,C=g.clientY-v.top;w.style.left=d+"px",w.style.top=C+"px"};window.showMomentCardGlow=function(g){const u=g.querySelector(".moment-glow");u&&(u.style.opacity="1")};window.hideMomentCardGlow=function(g){const u=g.querySelector(".moment-glow");u&&(u.style.opacity="0")};(function(){const g={titleElement:null,decorationEffect:"none",styleEffect:"none",originalText:"",init(){this.titleElement=document.getElementById("main-title"),this.titleElement&&(this.decorationEffect=this.titleElement.dataset.decorationEffect||"none",this.styleEffect=this.titleElement.dataset.styleEffect||"none",this.originalText=this.titleElement.dataset.originalText||this.titleElement.textContent.trim(),this.applyEffects())},applyEffects(){this.applyDecorationEffect(),this.applyStyleEffect()},applyDecorationEffect(){this.decorationEffect!=="none"&&((this.decorationEffect==="effect-particles"||this.decorationEffect==="effect-starlight")&&(this.titleElement.innerHTML=`<span><span><span>${this.originalText}</span></span></span>`),this.titleElement.classList.add(this.decorationEffect),this.decorationEffect==="effect-neon-edge"&&this.titleElement.setAttribute("data-text",this.originalText))},applyStyleEffect(){this.styleEffect!=="none"&&(this.titleElement.classList.add(this.styleEffect),(this.styleEffect==="effect-marker-pop"||this.styleEffect==="effect-diagonal-split")&&this.titleElement.setAttribute("data-text",this.originalText))}};document.addEventListener("DOMContentLoaded",()=>{g.init()})})();
